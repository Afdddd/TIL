# AOP란

### AOP란?

<br>

>**A**spect **O**riented **P**rogramming의 약자로 **관점(Aspect) 지향 프로그래밍**이다.

프로그램을 여러 관점으로 분리하여 독립적으로 관리(모듈화)하는 프로그래밍 패러다임이다.

주로 핵심 관심사와 횡단 관심사로 분리한다.

<br>

### 핵심 관심사와 횡단 관심사

<br>

- **핵심 관심사(Core Concerns)**: 애플리케이션의 주요 기능이나 비즈니스 로직을 말한다. 예를 들어, 주문 처리, 사용자 관리 등과 같은 비즈니스 로직이 이에 해당한다.
- **횡단 관심사(Cross-Cutting Concerns)**: 여러 모듈에 걸쳐 공통적으로 나타나는 부가적인 기능을 말한다. 예를 들어, 로깅, 보안, 예외 처리, 트랜잭션 관리 등이 이에 해당한다.


```

❓횡단 관심사라고 불리는 이유?
 특정 기능이나 로직이 애플리케이션의 여러 부분에 걸쳐 적용되기 때문에 **횡단**이라는 용어가 붙여졌다.
```

![Untitled](/Spring/img/aop.png)


<br><br>

### AOP의 주요 개념

<br>

**`Target`** 

어떤 대상에 부가 기능을 부여할 것인가를 지정.

<br>

**`Join Point`**

어디에 적용할 것인가를 지정(메서드, 필등 등).
Spring AOP에서는 항상 메서드로 지정된다.

<br>

**`Advice`**

어떤 상황에 부가 기능을 핵심 코드에 적용할지 지정.

- `Before` : Join Point가 실행되기 전에 실행
- `After returning`: 예외가 발생하지 않고 Join Point가 정상적으로 완료된 후 실행
- `After throwing` : 예외가 발생하여 메서드가 종료되면 실행
- `After` : 예외와 관계없이 Join Point가 완료된 후 실행
- `Around` :  Join Point 의 실행 전후에 필요한 전/후 처리 작업을 수행할 수 있으며, 메서드 호출을 감싸는(wrapper) 형태로 동작

<br>

**`Pointcut`** 

실제 Advice가 적용될 지점을 지정

<br><br>

### AOP의 구현방법

<br>

**컴파일 방식**

class → java로 컴파일 시점에 Aspect를 조립 

<br>

**클래스 로드시**

클래스로더가 클래스를 메서드 영역에 적재 시킬때 Aspect를 조립

<br>

**프록시 패턴**

핵심 기능만 있는 객체를 부가 기능이 있는 객체로 감싸 Aspect를 조립

스프링은 프록시를 사용해서 AOP를 구현한다.

<br>

```
💡스프링은 왜 프록시 패턴으로 구현할까?
사용자의 특정 호출 시점에 IoC 컨테이너에 의해 AOP를 할 수 있는 Proxy Bean을 생성한다. 
동적으로 생성된 Proxy Bean은 타깃의 메소드가 호출되는 시점에 부가기능을 추가할 메소드를 
자체적으로 판단하고 가로채어 부가기능을 주입해준다.
```

<br><br>

### AOP 표현식

<br>


**1. `execution` 표현식**

`execution` 표현식은 메서드 실행을 조인 포인트로 지정한다. 

```java
execution([접근제어자] 반환타입 패키지.클래스명.메서드명(파라미터))
```

- **접근제어자**: 생략 가능하며, public, protected, private 등을 지정할 수 있다.
- **반환타입**: 메서드의 반환 타입을 지정한다.  모든 반환값은 `*` 을 사용
- **패키지**: 패키지 경로를 지정한다.
- **클래스명**: 클래스 이름을 지정한다.
- **메서드명**: 메서드 이름을 지정한다.
- **파라미터**: 파라미터의 타입을 지정한다. `..`을 사용하면 모든 파라미터를 의미

<br>

```java

// com.study.service 패키지의 모든 메서드에 Advice 적용
@Before("execution(* com.study.service.*.*(..))")
public void logBeforeMethod() {
    System.out.println("메서드 시작 전");
}
```
